<div class="border-2 border-gray-300 rounded-lg p-3 bg-gray-50">
  <div class="mb-4 flex items-center gap-3">
    <button
      (click)="previousStep()"
      [disabled]="!hasPreviousStep()"
      class="px-4 py-2 bg-blue-500 text-white rounded-lg font-semibold text-sm transition-colors hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed"
    >
      â† Poprzedni krok
    </button>

    <input
      type="text"
      readonly
      [value]="selectedStep() !== null ? 'Krok ' + selectedStep() : 'Nie wybrano kroku'"
      class="py-2 px-4 text-base border-2 border-gray-300 rounded-lg bg-gray-100 font-semibold text-center w-48"
    />

    <button
      (click)="nextStep()"
      [disabled]="!hasNextStep()"
      class="px-4 py-2 bg-blue-500 text-white rounded-lg font-semibold text-sm transition-colors hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed"
    >
      NastÄ™pny krok â†’
    </button>

    <div class="flex-1"></div>

    <div class="flex items-center gap-2">
      <label class="text-gray-700 font-semibold text-sm">Skocz do kroku:</label>
      <input
        type="number"
        (change)="goToStep($event)"
        [value]="selectedStep() || ''"
        placeholder="Nr kroku"
        class="py-2 px-3 text-sm border-2 border-gray-300 rounded-lg w-24 focus:outline-none focus:border-[#667eea]"
      />
    </div>

    @if (selectedStep() !== null) {
      <span class="text-gray-600 font-semibold text-sm">
        Pakiety: {{ selectedStepPackages().size }}
      </span>
    }
  </div>

  @if (selectedStep() === null) {
    <div class="text-gray-400 text-center py-10 text-lg">
      Wybierz krok aby zobaczyÄ‡ przypisane pakiety
    </div>
  } @else if (selectedStepParts().length === 0) {
    <div class="text-gray-400 text-center py-10 text-lg">
      Brak przypisanych pakietÃ³w dla tego kroku
    </div>
  } @else {
    <div class="bg-white rounded-lg p-4">
      <h3 class="text-gray-800 mb-3 font-semibold text-lg border-b-2 border-[#667eea] pb-2">
        ğŸ“¦ Pakiety dla kroku {{ selectedStep() }}
      </h3>
      <div class="grid grid-cols-[repeat(auto-fill,minmax(300px,1fr))] gap-4">
        @for (part of selectedStepParts(); track part.pkg) {
          <app-part-item
            [part]="part"
            [isSelected]="selectedStepPackages().has(part.pkg)"
            [useLargeImage]="true"
          />
        }
      </div>
    </div>
  }
</div>
